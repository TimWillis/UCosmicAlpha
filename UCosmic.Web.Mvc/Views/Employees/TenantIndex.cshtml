@{
    ViewBag.Title = "Professional Engagement Summary";
}

@section bib
{
    <nav class="bib hide" data-current-bib="summary">
        @Html.Partial(MVC.Employees.Views._Bib)
    </nav>
}

@section styles
{
    <link rel="stylesheet" type="text/css" href="~/styles/sass/sheets/employees/summary.css" />

}
@section scripts
{
    @* need this for the google visualization packages *@

    <script src="https://www.google.com/jsapi"></script>

    @* IE8 cannot handle D3 or SVG's in general *@
    <!--[if !IE | gt IE 8]><!-->

    <script src="~/scripts/oss/d3.v3.js"></script>

    <!--<![endif]-->

    @* employee API routes come from CSHTML file *@

    <script>
        @{Html.RenderPartial(MVC.JavaScriptRoutes.Views.Employees);}
    </script>

    @* load historyjs, linqjs, viewmodel, & other supporting scripts *@
    @Scripts.Render("~/bundles/employees/summary")

    @* Google API needs to be called outside of JQuery ready() *@

    <script>
        Employees.ViewModels.Summary.loadGoogleVisualization().done(function () {
            var viewModel = new Employees.ViewModels.Summary({
                tenantDomain: '@ViewBag.EmployeesDomain',
                element: $('[data-current-module=employees]')[0],
                chart: {
                    boxElementId: 'geochart_box',
                    googleElementId: 'google_geochart',
                    transparentImgSrc: '@Url.Content("~/images/transparent.png")',
                    keepAspectRatio: true,
                },
            });
            viewModel.applyBindings();
        });
    </script>

}

<div class="content fixed to-top" data-current-module="employees">
    <form class="group">
        @* LEFT *@
        <div class="on-left from-top">

            @* HEADER *@
            <header>
                <h1>
                    @ViewBag.Title
                </h1>
            </header>

            @* TOTALS SUMMARY *@
            <div data-bind="with: activitiesSummary" style="margin: 16px 0; height: 30px; font-size: 20px;">
                <strong data-bind="text: personCount" style="font-size: 24px;">?</strong>
                <span data-bind="visible: personCount() == 1" style="display: none;">person</span>
                <span data-bind="visible: personCount() != 1">people</span>
                <span data-bind="visible: personCount() > 0" style="display: none;">with
                    @*<span data-bind="visible: personCount() == 1" style="display: none;">has</span>
                    <span data-bind="visible: personCount() != 1">have</span>*@
                    <strong data-bind="text: activityCount" style="font-size: 24px;">?</strong>
                    <span data-bind="visible: activityCount() == 1" style="display: none;">activity</span>
                    <span data-bind="visible: activityCount() != 1">activities</span>
                    in
                    <strong data-bind="text: locationCount" style="font-size: 24px;">?</strong>
                    <span data-bind="visible: locationCount() == 1" style="display: none;">location.</span>
                    <span data-bind="visible: locationCount() != 1">locations.</span>
                </span>
            </div>

            @* CHART INSTRUCTIONS & SPINNER *@
            <div style="margin: 1em 0; height: 28px;">
                <div class="group">
                    <div class="on-left">
                        <div data-bind="visible: !geoChartSpinner.isVisible() && hasPivotData()" style="display: none; line-height: 28px;">
                            <img src="@Url.HttpRouteUrl(null, new { controller = "Employees", action = "GetSettingsIcon", domain = @ViewBag.EmployeesDomain, name = "global-view" })"
                                alt="Global view" width="24" height="24" style="" />
                            <strong>Global View:</strong>
                            <span>double click a region for more information.</span>
                        </div>
                        <div data-bind="visible: !geoChartSpinner.isVisible() && !hasPivotData()" style="display: none; line-height: 28px;">
                            There are no international faculty or staff relationships to summarize.
                        </div>
                    </div>
                    <div class="on-right">
                        <div data-bind="visible: geoChartSpinner.isVisible">
                            <img src="~/images/icons/spinner/spinner-20-blue.gif" alt="" />
                            <strong>Crunching the numbers...</strong>
                        </div>
                    </div>
                </div>
            </div>

            @* GEOCHART *@
            <div id="geochart_box" data-bind="css: { 'keep-aspect-ratio-480': settings.chart.keepAspectRatio }">

                @* GOOGLE ELEMENT & BACKGROUND IMAGE *@
                <div class="chart-bg"></div>
                <div id="google_geochart"></div>

                @* CUSTOM CHART OVERLAYS *@
                <div class="overlays">

                    @* ACTIVITIES | PEOPLE BUTTONS OVERLAY *@
                    <div class="data-pivoter group" data-bind="visible: isGeoChartReady">
                        <input type="button" value="Activities" class="on-left" data-bind="click: pivotActivities, css: { active: isPivotActivities }" />
                        <input type="button" value="People" class="on-left" data-bind="click: pivotPeople, css: { active: isPivotPeople }" />
                    </div>

                    @* PLACE OVERLAYS *@
                    <div class="places" data-bind="css: { 'for-svg': isD3Defined }">

                        @* PLACE DATA *@
                        <ul class="data">
                            <li class="pacific-ocean" title="Pacific Ocean" data-place-id="7872">
                                <img src="~/images/geochart/up/pacific-ocean.png" alt="" class="no-hover" />
                                <img src="~/images/geochart/hot/pacific-ocean.png" alt="" class="hover" style="display: none;" />
                            </li>
                            <li class="gulf-of-mexico" title="Gulf of Mexico" data-place-id="7859">
                                <img src="~/images/geochart/up/gulf-of-mexico.png" alt="" class="no-hover" />
                                <img src="~/images/geochart/hot/gulf-of-mexico.png" alt="" class="hover" style="display: none;" />
                            </li>
                            <li class="caribbean-sea" title="Caribbean Sea" data-place-id="7845">
                                <img src="~/images/geochart/up/caribbean-sea.png" alt="" class="no-hover" />
                                <img src="~/images/geochart/hot/caribbean-sea.png" alt="" class="hover" style="display: none;" />
                            </li>
                            <li class="atlantic-ocean" title="Atlantic Ocean" data-place-id="8296">
                                <img src="~/images/geochart/up/atlantic-ocean.png" alt="" class="no-hover" />
                                <img src="~/images/geochart/hot/atlantic-ocean.png" alt="" class="hover" style="display: none;" />
                            </li>
                            <li class="southern-ocean" title="Southern Ocean" data-place-id="7833">
                                <img src="~/images/geochart/up/southern-ocean.png" alt="" class="no-hover" />
                                <img src="~/images/geochart/hot/southern-ocean.png" alt="" class="hover" style="display: none;" />
                            </li>
                            <li class="arctic-ocean" title="Arctic Ocean" data-place-id="7837">
                                <img src="~/images/geochart/up/arctic-ocean.png" alt="" class="no-hover" />
                                <img src="~/images/geochart/hot/arctic-ocean.png" alt="" class="hover" style="display: none;" />
                            </li>
                            <li class="indian-ocean" title="Indian Ocean" data-place-id="7863">
                                <img src="~/images/geochart/up/indian-ocean.png" alt="" class="no-hover" />
                                <img src="~/images/geochart/hot/indian-ocean.png" alt="" class="hover" style="display: none;" />
                            </li>
                            <li class="antarctica" title="Antarctica" data-place-id="17">
                                <img src="~/images/geochart/up/antarctica.png" alt="" class="no-hover" />
                                <img src="~/images/geochart/hot/antarctica.png" alt="" class="hover" style="display: none;" />
                            </li>
                        </ul>

                        @* PLACE UI *@
                        <ul class="ui" data-bind="foreach: placeOverlays, visible: isGeoChartReady">
                            <li data-bind="attr: { 'class': className }">
                                <div class="hit" data-bind="with: imageSwapper">
                                    <img data-bind="attr: { src: src }, event: { mouseenter: onMouseEnter, mouseleave: onMouseLeave }"
                                        alt="" src="~/images/transparent.png" />
                                </div>
                                <div class="tooltip" style="display: none;">
                                    <div class="title">
                                        <strong data-bind="text: title"></strong>
                                    </div>
                                    <div class="total">
                                        <span data-bind="visible: $parent.isPivotPeople()">Total People:</span>
                                        <span data-bind="visible: $parent.isPivotActivities()">Total Activities:</span>
                                        <strong data-bind="text: total">0</strong>
                                    </div>
                                </div>
                            </li>
                        </ul>

                    </div>
                </div>
            </div>
        </div>

        @* RIGHT *@
        <aside class="on-right from-top">
        </aside>
    </form>
</div>
