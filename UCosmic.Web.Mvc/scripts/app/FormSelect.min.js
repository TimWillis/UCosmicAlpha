var App;(function(n){var t=function(){function n(t){var i=this,r;this.settings=t,this.settings=$.extend({},n.defaultSettings,this.settings),this._initKendoOptions(),r=this._getInitialOptions(),this.options=ko.observableArray(r),this.value=ko.observable(this.settings.value),this.caption=ko.observable(this.settings.optionsCaption),this.options.subscribe(function(n){i._onOptionsChanged(n)}),this.value.subscribe(function(n){i._onValueChanged(n)})}return n.prototype._getInitialOptions=function(){var n=this.settings.options||[],i=this.settings.value,t;return!n.length&&this.settings.loadingText&&(t={text:this.settings.loadingText,value:i},n.push(t)),n},n.prototype._onValueChanged=function(n){var t=this.options().slice(0);t&&t.length&&t[0].text==this.settings.loadingText&&t[0].value!=n&&(t=t.slice(1),t.unshift({text:this.settings.loadingText,value:n}),this.options(t)),this._ensureKendoTextColor(),this._ensureKendoSelection()},n.prototype._onOptionsChanged=function(n){var i=this.caption(),t;n=n||[],i?(t=n.length?n[0]:undefined,t&&typeof t.value=="undefined"||n.unshift({text:i,value:undefined})):(t=n.length?n[0]:undefined,t&&typeof t.value=="undefined"&&n.shift())},n.prototype.applyKendo=function(){var n=this.$select;n&&this.settings.kendoOptions&&(n.kendoDropDownList(this.settings.kendoOptions),this._ensureKendoTextColor())},n.prototype._initKendoOptions=function(){var i=this,t;this.settings.kendoOptions&&(this.settings.kendoOptions=$.extend({},n.defaultKendoOptions,this.settings.kendoOptions),t=this.settings.kendoOptions.open,this.settings.kendoOptions.open=function(n){i._maximizeKendoPopup(n),t&&t(n)})},n.prototype._getKendoDropDownList=function(){return this.$select?this.$select.data("kendoDropDownList"):undefined},n.prototype._ensureKendoTextColor=function(){var r=this.value(),n=this.$select,t=this._getKendoDropDownList(),i;n&&n.length&&this.settings.textColor&&this.settings.captionTextColor&&t&&(i=r?this.settings.textColor:this.settings.captionTextColor,t.span.css({color:i}))},n.prototype._ensureKendoSelection=function(){var t=this.value(),n=this._getKendoDropDownList();n&&n.select(function(n){return n.value==t})},n.prototype._maximizeKendoPopup=function(n){setTimeout(function(){var t=n.sender.ul,e=t.outerHeight(!0),i=t.offset().top,r=n.sender.wrapper.offset().top,o=$(window).outerHeight(),u=$(window).scrollTop(),f=i<r?r-u-20:o-i+u-20;e!=f&&(n.sender.options.height=f,n.sender.refresh())},0)},n.defaultSettings={loadingText:"[Loading...]",options:[],textColor:"#000",captionTextColor:"#666"},n.defaultKendoOptions={animation:!1},n}();n.FormSelect=t})(App||(App={}))