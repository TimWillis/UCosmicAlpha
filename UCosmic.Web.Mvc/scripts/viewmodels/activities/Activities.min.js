var Activities;(function(n){(function(n){var i=function(){function n(){}return n.prototype.load=function(){var r=this,i=$.Deferred(),n=$("#activities_api").text();return n="{0}?{1}".format(n,$.param({pageSize:500,pageNumber:1})),$.ajax({url:n,cache:!1}).done(function(n){var u={items:{create:function(n){return new t(n.data,n.parent)}}};ko.mapping.fromJS(n,u,r),i.resolve()}),i},n.iconMaxSide=64,n}(),t;n.ActivityList=i,t=function(){function t(t,i){var r=this,u;this.mode=ko.observable(),this.editUrl=ko.computed(function(){var n=r.activityId();return $("#activity_edit").text().format(n)}),this.titleText=ko.computed(function(){var n=r.title();return n||"[Untitled Activity #{0}]".format(r.activityId())}),this.isDraft=ko.computed(function(){var t=r.mode();return t?t==n.ActivityMode.draft:!1}),this.isPublished=ko.computed(function(){var t=r.mode();return t?t==n.ActivityMode.published:!1}),this.datesText=ko.computed(function(){return r._computeDatesText()}),this._owner=i,t.types&&t.types.length&&(t.types=Enumerable.From(t.types).OrderBy(function(n){return n.rank}).ToArray()),u={},ko.mapping.fromJS(t,u,this)}return t.prototype.typeText=function(n){var i=this.types(),t=i[n].text();return n<i.length-1&&(t="{0}; ".format(t)),t},t.prototype.placeText=function(n){var i=this.places(),t=i[n].placeName();return n<i.length-1&&(t="{0}, ".format(t)),t},t.prototype.typeIcon=function(n){return $("#type_icon_api").text().format(n)},t.prototype.documentIcon=function(n){var t=$("#document_icon_api").text().format(this.activityId(),n),r={maxSide:i.iconMaxSide};return"{0}?{1}".format(t,$.param(r))},t.prototype._computeDatesText=function(){var f=this.startsOn(),t=this.endsOn(),r=this.startsFormat()||"M/D/YYYY",i=this.endsFormat()||this.startsFormat()||"M/D/YYYY",u,n;return r=r.toUpperCase(),i=i.toUpperCase(),u=this.onGoing(),f?(n=moment(f).format(r),u?n="{0} (Ongoing)".format(n):t&&(n="{0} - {1}".format(n,moment(t).format(i)))):t?n=moment(t).format(i):u&&(n="(Ongoing)"),n},t.prototype.purge=function(){var t=this,n=$("#confirmActivityDeleteDialog");n.dialog({dialogClass:"jquery-ui no-close",closeOnEscape:!1,width:"auto",resizable:!1,modal:!0,buttons:[{text:"Yes, confirm delete",click:function(){var i=n.parents(".ui-dialog").find("button");$.each(i,function(){$(this).attr("disabled","disabled")}),n.find(".spinner").css("visibility",""),$.ajax({type:"DELETE",url:$("#activity_api").text().format(t.activityId())}).done(function(){n.dialog("close"),t._owner.items.remove(t)}).fail(function(n){App.Failures.message(n,"while trying to delete your activity",!0)}).always(function(){$.each(i,function(){$(this).removeAttr("disabled")}),n.find(".spinner").css("visibility","hidden")})}},{text:"No, cancel delete",click:function(){n.dialog("close")},"data-css-link":!0}]})},t}(),n.ActivityListItem=t})(n.ViewModels||(n.ViewModels={}));var t=n.ViewModels})(Activities||(Activities={}))