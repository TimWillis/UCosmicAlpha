var ViewModels;(function(n){(function(n){var t=function(){function n(){}return n}(),i;n.ActivitySearchInput=t,i=function(){function n(n){this.personId=n}return n.prototype.load=function(){var f=this,e=$.Deferred(),o=$.Deferred(),r,u,i;return $.get(App.Routes.WebApi.Activities.Locations.get()).done(function(n){o.resolve(n)}).fail(function(n,t,i){o.reject(n,t,i)}),r=$.Deferred(),$.get(App.Routes.WebApi.Employees.ModuleSettings.ActivityTypes.get()).done(function(n){r.resolve(n)}).fail(function(n,t,i){r.reject(n,t,i)}),u=$.Deferred(),i=new t,i.personId=this.personId,i.orderBy="",i.pageNumber=1,i.pageSize=App.Constants.int32Max,$.get(App.Routes.WebApi.Activities.get(),i).done(function(n){u.resolve(n)}).fail(function(n,t,i){u.reject(n,t,i)}),$.when(r,o,u).done(function(t,i,r){f.activityTypesList=t,f.activityLocationsList=i;var u=function(t){ko.mapping.fromJS(t,{},this),this.proxyImageSource=App.Routes.WebApi.Activities.Documents.Thumbnail.get(t.activityId,t.id,{maxSide:n.iconMaxSide})},o={documents:{create:function(n){return new u(n.data)}},startsOn:{create:function(n){return n.data!=null?ko.observable(moment(n.data).toDate()):ko.observable()}},endsOn:{create:function(n){return n.data!=null?ko.observable(moment(n.data).toDate()):ko.observable()}}};ko.mapping.fromJS(r,o,f),e.resolve()}).fail(function(n,t,i){e.reject(n,t,i)}),e},n.prototype.deleteActivity=function(n,t,i){var u=this,r=$("#confirmActivityDeleteDialog");r.dialog({dialogClass:"jquery-ui no-close",width:"auto",resizable:!1,modal:!0,closeOnEscape:!1,buttons:[{text:"Yes, confirm delete",click:function(){var t=r.parents(".ui-dialog").find("button");$.each(t,function(){$(this).attr("disabled","disabled")}),r.find(".spinner").css("visibility",""),$.ajax({type:"DELETE",url:App.Routes.WebApi.Activities.del(n.id())}).done(function(){var i,f,t;for(r.dialog("close"),i=-1,f=u.items(),t=0;t<f.length;t++)if(f[t].id()==n.id()){i=t;break}i>=0&&u.items.splice(i,1)}).fail(function(n){App.Failures.message(n,"while trying to delete your activity",!0)}).always(function(){$.each(t,function(){$(this).removeAttr("disabled")}),r.find(".spinner").css("visibility","hidden")})}},{text:"No, cancel delete",click:function(){var n=u;n=i,r.dialog("close")},"data-css-link":!0}]})},n.prototype.editActivityUrl=function(n){return App.Routes.Mvc.My.Profile.activityEdit(n)},n.prototype.getTypeName=function(n){var i="",t;if(this.activityTypesList!=null){for(t=0;t<this.activityTypesList.length&&n!=this.activityTypesList[t].id;)t+=1;t<this.activityTypesList.length&&(i=this.activityTypesList[t].type)}return i},n.prototype.getLocationName=function(n){var i="",t;if(this.activityLocationsList!=null){for(t=0;t<this.activityLocationsList.length&&n!=this.activityLocationsList[t].id;)t+=1;t<this.activityLocationsList.length&&(i=this.activityLocationsList[t].officialName)}return i},n.prototype.activityDatesFormatted=function(n,t,i,r){var u="";return r=r!=null?r.toUpperCase():"MM/DD/YYYY",n==null?t!=null?u=moment(t).format(r):i&&(u="(Ongoing)"):(u=moment(n).format(r),i?u+=" (Ongoing)":t!=null&&(u+=" - "+moment(t).format(r))),u.length>0&&(u+="  "),u},n.prototype.activityTypesFormatted=function(n){for(var i="",r,t=0;t<this.activityTypesList.length;t+=1)for(r=0;r<n.length;r+=1)n[r].typeId()==this.activityTypesList[t].id&&(i.length>0&&(i+="; "),i+=this.activityTypesList[t].type);return i},n.prototype.activityLocationsFormatted=function(n){for(var i="",t=0;t<n.length;t+=1)t>0&&(i+=", "),i+=this.getLocationName(n[t].placeId());return i},n.prototype.getActivityTypeIconName=function(n){for(var t=0;t<this.activityTypesList.length&&this.activityTypesList[t].id!=n;)t+=1;return t<this.activityTypesList.length?this.activityTypesList[t].iconName:null},n.prototype.getActivityTypeToolTip=function(n){for(var t=0;t<this.activityTypesList.length&&this.activityTypesList[t].id!=n;)t+=1;return t<this.activityTypesList.length?this.activityTypesList[t].type:null},n.iconMaxSide=64,n}(),n.ActivityList=i})(n.Activities||(n.Activities={}));var t=n.Activities})(ViewModels||(ViewModels={}))