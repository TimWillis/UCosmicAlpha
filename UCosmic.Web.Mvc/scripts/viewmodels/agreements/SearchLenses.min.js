var Agreements;(function(n){(function(n){var t=function(){function t(i){var r=this,u,f;this.settings=i;this.lens=ko.observable(sessionStorage.getItem(t.LensSessionKey)||"table");this._inputChanged=ko.computed(function(){sessionStorage.setItem(t.LensSessionKey,r.lens())}).extend({throttle:0});this.isTableLens=ko.computed(function(){return r.lens()=="table"});this.isMapLens=ko.computed(function(){return r.lens()=="map"});this.sammy=Sammy();this._hasMapBeenResizedOnce=!1;this._runSammy();this.table=new n.SearchTable({element:undefined,domain:this.settings.domain,visibility:this.settings.visibility,route:"table",activationRoute:"#/table/",detailUrl:this.settings.detailUrl,sammy:this.sammy});this.map=new n.SearchMap({element:undefined,domain:this.settings.domain,visibility:this.settings.visibility,route:"map",activationRoute:"#/map/",detailUrl:this.settings.detailUrl,sammy:this.sammy,partnerPlacesApi:this.settings.partnerPlacesApi,partnersApi:this.settings.partnersApi,graphicsCircleApi:this.settings.graphicsCircleApi,summaryApi:this.settings.summaryApi});this.sammy.run();u=this.sammy.getLocation();f="#/{0}/".format(this.lens());u.indexOf(f)<0&&(this.isTableLens()?(this.table.setLocation(),this.table.activate()):this.isMapLens()&&(this.map.setLocation(),this.map.activate()))}return t.prototype._runSammy=function(){var n=this;this.sammy.before(/\#\/table\/(.*)\//,function(){n.viewTable()});this.sammy.before(/\#\/map\/(.*)\//,function(){n.viewMap()});this.sammy.get("#/:lens/",function(){var t=this;n.lens(t.params.lens)})},t.prototype.viewTable=function(){this.isTableLens()||(this.map.deactivate(),this.table.countryCode(this.map.countryCode()),this.lens("table"),this.table.activate())},t.prototype.viewMap=function(){var n=this;this.isMapLens()||(this.table.deactivate(),this.map.deactivate(),this.map.countryCode(this.table.countryCode()),this.map.loadViewport=1,this.lens("map"),this._hasMapBeenResizedOnce?this.map.activate():this.map.triggerMapResize().done(function(){n._hasMapBeenResizedOnce=!0;n.map.activate()}))},t.prototype.resetFilters=function(){this.table.keyword("");this.table.countryCode("any");this.table.pager.input.pageNumberText("1");this.map.continentCode("any");this.map.countryCode("any");this.map.placeId(0);this.map.zoom(1);this.map.lat(n.SearchMap.defaultMapCenter.lat());this.map.lng(n.SearchMap.defaultMapCenter.lng())},t.LensSessionKey="AgreementSearchLens",t}();n.SearchLenses=t})(n.ViewModels||(n.ViewModels={}));var t=n.ViewModels})(Agreements||(Agreements={}));