var agreements;(function(n){var t=function(){function n(n,t,i){this.contactPhoneTextValue=ko.observable(""),this.contactPhoneType=ko.observable(),this.contactPhones=ko.observableArray(),this.phoneTypes=ko.mapping.fromJS([]),this.$phoneTypes=ko.observable(),this.selectConstructor=function(n,t){this.name=n,this.id=t},this.agreementId=n,this.contactId=i,this.establishmentItemViewModel=t,this.removePhone=this.removePhone.bind(this),this.addPhone=this.addPhone.bind(this),this.phoneTypes=ko.mapping.fromJS([new this.selectConstructor("[None]",""),new this.selectConstructor("home","home"),new this.selectConstructor("work","work"),new this.selectConstructor("mobile","mobile")]),this.bindJquery()}return n.prototype.removePhone=function(n,t){var i=this,r=App.Routes.WebApi.Agreements.Contacts.Phones.del(this.agreementId.val,n.contactId,n.id);$.ajax({url:r,type:"DELETE",success:function(){i.contactPhones.remove(n),$("body").css("min-height",$(window).height()+$("body").height()-$(window).height()*1.1)}}),this.contactPhones.remove(n),t.preventDefault(),t.stopPropagation()},n.prototype.addPhone=function(){this.contactPhoneTextValue().length>0&&(this.contactPhones.push({type:"",contactId:"",value:this.contactPhoneTextValue()}),this.contactPhoneTextValue(""),$(".phoneTypes").kendoDropDownList({dataTextField:"name",dataValueField:"id",dataSource:new kendo.data.DataSource({data:ko.mapping.toJS(this.phoneTypes())})}))},n.prototype.bindJquery=function(){var n=this,t=this;this.contactPhoneTextValue.subscribe(function(){if(n.contactPhoneTextValue().length>0)if(n.contactId()){var i=App.Routes.WebApi.Agreements.Contacts.Phones.post(n.agreementId.val,n.contactId()),t={id:"0",type:"",contactId:n.contactId(),value:n.contactPhoneTextValue()};$.post(i,t).done(function(i,r,u){var f=u.getResponseHeader("Location");t.id=f.substring(f.lastIndexOf("/")+1),n.contactPhones.push(t),n.contactPhoneTextValue(""),$(".phoneTypes").kendoDropDownList({dataTextField:"name",dataValueField:"id",dataSource:new kendo.data.DataSource({data:ko.mapping.toJS(n.phoneTypes())})})}).fail(function(t){t.status===400&&(n.establishmentItemViewModel.$genericAlertDialog.find("p.content").html(t.responseText.replace("\n","<br /><br />")),n.establishmentItemViewModel.$genericAlertDialog.dialog({title:"Alert Message",dialogClass:"jquery-ui",width:"auto",resizable:!1,modal:!0,buttons:{Ok:function(){n.establishmentItemViewModel.$genericAlertDialog.dialog("close")}}}))})}else n.contactPhones.push({id:"",type:"",contactId:"",value:n.contactPhoneTextValue()}),n.contactPhoneTextValue(""),$(".phoneTypes").kendoDropDownList({dataTextField:"name",dataValueField:"id",dataSource:new kendo.data.DataSource({data:ko.mapping.toJS(n.phoneTypes())})})})},n}();n.phones=t})(agreements||(agreements={}))