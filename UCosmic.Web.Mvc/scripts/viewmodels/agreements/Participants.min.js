var Agreements;(function(n){var t=function(){function n(n,t,i,r,u){var f=this;this.participantsExport=ko.mapping.fromJS([]);this.participants=ko.mapping.fromJS([]);this.participantsErrorMsg=ko.observable();this.removeParticipant=this.removeParticipant.bind(this);this.agreementIsEdit=i;this.agreementId=n;this.dfdPopParticipants=t;this.hasBoundSearch=u;this.establishmentSearchViewModel=r;this.participantsShowErrorMsg=ko.computed(function(){var n=!1;return $.each(f.participants(),function(t,i){i.isOwner()==!0&&(n=!0)}),n==!1?(f.participantsErrorMsg("Home participant is required."),!0):!1})}return n.prototype.removeParticipant=function(n,t){var i,r;return confirm('Are you sure you want to remove "'+n.establishmentTranslatedName()+'" as a participant from this agreement?')&&(i=this,this.agreementIsEdit()?(r=App.Routes.WebApi.Agreements.Participants.del(this.agreementId,ko.dataFor(t.target).establishmentId()),$.ajax({url:r,type:"DELETE",success:function(){i.participants.remove(function(t){return t.establishmentId()===n.establishmentId()&&$(t.participantEl).slideUp("fast",function(){i.participants.remove(t);$("body").css("min-height",$(window).height()+$("body").height()-$(window).height()*1.1)}),!1})},error:function(n){alert(n.responseText)}})):i.participants.remove(function(t){return t.establishmentId()===n.establishmentId()&&$(t.participantEl).slideUp("fast",function(){i.participants.remove(t);$("body").css("min-height",$(window).height()+$("body").height()-$(window).height()*1.1)}),!1})),t.preventDefault(),t.stopPropagation(),!1},n.prototype.receiveParticipants=function(n){n?ko.mapping.fromJS(n,this.participants):ko.mapping.fromJS({items:[],itemTotal:0},this.participants)},n.prototype.populateParticipants=function(){var n=this;$.get(App.Routes.WebApi.Agreements.Participants.get(this.agreementId)).done(function(t){n.receiveParticipants(t);n.dfdPopParticipants.resolve()})},n.prototype.addParticipant=function(){this.establishmentSearchViewModel.sammy.setLocation("#/page/1/");this.hasBoundSearch.does=!0},n}();n.Participants=t})(Agreements||(Agreements={}));