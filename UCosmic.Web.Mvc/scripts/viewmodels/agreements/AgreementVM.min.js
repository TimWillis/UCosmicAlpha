define(["require","exports","../amd-modules/Establishments/SearchResult","../amd-modules/Establishments/Search"],function(n,t,i,r){function f(n){var t=this;ko.mapping.fromJS(n,{},t),t.isNotOwner=ko.computed(function(){return!t.isOwner()}),t.participantEl=undefined}function h(){var n=this,i,r,t,o,e;n.isBound=ko.observable(),n.back=function(){history.back()},n.sideSwiper=new App.SideSwiper({speed:"",frameWidth:970,root:"[data-current-module=agreements]"}),n.participants=ko.observableArray(),r=$("#tenancy_domain").val(),t=new f({isOwner:!0,establishment:new u({id:1,officialName:"University of Cincinnati",translatedName:"University of Cincinnati",officialUrl:"www.uc.edu",countryName:"United States",countryCode:"asdf",uCosmicCode:"asdf",ceebCode:"asdf"},i)}),r==="usf.edu"&&(t.establishment=new u({id:1,officialName:"University of South Florida",translatedName:"University of South Florida",officialUrl:"www.usf.edu",countryName:"United States",countryCode:"asdf",uCosmicCode:"asdf",ceebCode:"asdf"},i)),r==="lehigh.edu"&&(t.establishment=new u({id:1,officialName:"Lehigh University",translatedName:"Lehigh University",officialUrl:"www.lehigh.edu",countryName:"United States",countryCode:"asdf",uCosmicCode:"asdf",ceebCode:"asdf"},i)),r==="umn.edu"&&(t.establishment=new u({id:1,officialName:"University of Minnesota",translatedName:"University of Minnesota",officialUrl:"www.umn.edu",countryName:"United States",countryCode:"asdf",uCosmicCode:"asdf",ceebCode:"asdf"},i)),r==="uc.edu"&&(t.establishment=new u({id:1,officialName:"University of Cincinnati",translatedName:"University of Cincinnati",officialUrl:"www.uc.edu",countryName:"United States",countryCode:"asdf",uCosmicCode:"asdf",ceebCode:"asdf"},i)),r==="suny.edu"&&(t.establishment=new u({id:1,officialName:"State University of New York",translatedName:"State University of New York",officialUrl:"www.suny.edu",countryName:"United States",countryCode:"asdf",uCosmicCode:"asdf",ceebCode:"asdf"},i)),n.participants.push(t),n.establishmentSearchViewModel=new s,n.establishmentSearchViewModel.sammy=undefined,n.establishmentSearchViewModel.nextPage=function(){if(n.establishmentSearchViewModel.nextEnabled()){var t=parseInt(n.establishmentSearchViewModel.pageNumber())+1;location.hash="/participants/add/page/"+t}},n.establishmentSearchViewModel.prevPage=function(){n.establishmentSearchViewModel.prevEnabled()&&history.back()},n.addParticipant=function(t){var i=new f({isOwner:!1,establishment:t});n.participants.push(i),location.hash="#/"},n.establishmentSearchViewModel.items.subscribe(function(t){if(t&&t.length)for(var i=0;i<t.length;i++)t[i].clickAction!==n.addParticipant&&(t[i].clickAction=n.addParticipant)}),n.removeParticipant=function(t,i){return confirm('Are you sure you want to remove "'+t.translatedName()+'" as a participant from this agreement?')&&n.participants.remove(function(i){return i.establishment.id()===t.id()&&$(i.participantEl).slideUp("fast",function(){n.participants.remove(i)}),!1}),i.preventDefault(),i.stopPropagation(),!1},o="data-side-swiper",e=undefined,n.sammy=function(){return e?e:e=Sammy(function(){this.get("#/",function(){$("#participants_add").attr(o)==="on"&&n.sideSwiper.prev()}),this.get("#/participants/add/page/:pageNumber",function(){if($("#all").attr(o)==="on")n.sideSwiper.next(),n.establishmentSearchViewModel.trail().push(this.path);else if($("#participants_add").attr(o)==="on"){var r=this.params.pageNumber,t=n.establishmentSearchViewModel.trail(),i;if(n.establishmentSearchViewModel.pageNumber(r),t.length>0&&t[t.length-1]===this.path)return;if(t.length>1&&t[t.length-2]===this.path){t.pop(),i=n.establishmentSearchViewModel.$itemsPage().clone(!0).removeAttr("data-bind").data("bind",undefined).removeAttr("id"),i.appendTo(n.establishmentSearchViewModel.$itemsPage().parent()),n.establishmentSearchViewModel.$itemsPage().attr("data-side-swiper","off").hide(),n.establishmentSearchViewModel.lockAnimation(),$(window).scrollTop(0),n.establishmentSearchViewModel.sideSwiper.prev(1,function(){n.establishmentSearchViewModel.$itemsPage().siblings().remove(),n.establishmentSearchViewModel.unlockAnimation()});return}t.length>0&&(i=n.establishmentSearchViewModel.$itemsPage().clone(!0).removeAttr("data-bind").data("bind",undefined).removeAttr("id"),i.insertBefore(n.establishmentSearchViewModel.$itemsPage()),n.establishmentSearchViewModel.$itemsPage().attr("data-side-swiper","off").data("side-swiper","off").hide(),n.establishmentSearchViewModel.lockAnimation(),$(window).scrollTop(0),n.establishmentSearchViewModel.sideSwiper.next(1,function(){n.establishmentSearchViewModel.unlockAnimation()})),t.push(this.path)}}),this.get("",function(){this.app.runRoute("get","#/")})})},n.isBound(!0)}var e=i,o=r,u=e.SearchResult,s=o.Search;t.InstitutionalAgreementEditModel=h})