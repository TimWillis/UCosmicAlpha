define(["require","exports","../amd-modules/Establishments/SearchResult","../amd-modules/Establishments/Search"],function(n,t,i,r){var s=i,h=r,u=s.SearchResult,f=h.Search,e=function(){function n(n){this.establishment=new u({id:1,officialName:"University of Cincinnati",translatedName:"University of Cincinnati",officialUrl:"www.uc.edu",countryName:"United States",countryCode:"asdf",uCosmicCode:"asdf",ceebCode:"asdf"},new f(!1)),this.isNotOwner=ko.computed(function(){return!1});n:!1;n:new u({id:1,officialName:"University of Cincinnati",translatedName:"University of Cincinnati",officialUrl:"www.uc.edu",countryName:"United States",countryCode:"asdf",uCosmicCode:"asdf",ceebCode:"asdf"},new f(!1));n:ko.computed(function(){return!n.isOwner})}return n}(),o;t.InstitutionalAgreementParticipantModel=e,o=function(){function n(n){typeof n=="undefined"&&(n=!0),this.initDefaultPageRoute=n,this.isBound=ko.observable(),this.back=function(){history.back()},this.sideSwiper=new App.SideSwiper({speed:"",frameWidth:970,root:"[data-current-module=agreements]"}),this.participants=ko.observableArray(),this.owner=new f(!1),this.tenantDomain="uc.edu",this.sammy=Sammy(),this.sammyBeforeRoute=/\#\/page\/(.*)\//,this.sammyGetPageRoute="#/page/:pageNumber/",this.sammyDefaultPageRoute="/Establishments[/]?",this.trail=ko.observableArray([]),this.$itemsPage=undefined,this.nextForceDisabled=ko.observable(!1),this.prevForceDisabled=ko.observable(!1),this.pageNumber=ko.observable(),this.populateParticipants(),this.setupSearchVM(),this._setupSammy(),this.isBound(!0)}return n.prototype.populateParticipants=function(){var n=new e({isOwner:!0,establishment:new u({id:1,officialName:"University of Cincinnati",translatedName:"University of Cincinnati",officialUrl:"www.uc.edu",countryName:"United States",countryCode:"asdf",uCosmicCode:"asdf",ceebCode:"asdf"},this.owner)});this.tenantDomain==="usf.edu"&&(n.establishment=new u({id:1,officialName:"University of South Florida",translatedName:"University of South Florida",officialUrl:"www.usf.edu",countryName:"United States",countryCode:"asdf",uCosmicCode:"asdf",ceebCode:"asdf"},this.owner)),this.tenantDomain==="lehigh.edu"&&(n.establishment=new u({id:1,officialName:"Lehigh University",translatedName:"Lehigh University",officialUrl:"www.lehigh.edu",countryName:"United States",countryCode:"asdf",uCosmicCode:"asdf",ceebCode:"asdf"},this.owner)),this.tenantDomain==="umn.edu"&&(n.establishment=new u({id:1,officialName:"University of Minnesota",translatedName:"University of Minnesota",officialUrl:"www.umn.edu",countryName:"United States",countryCode:"asdf",uCosmicCode:"asdf",ceebCode:"asdf"},this.owner)),this.tenantDomain==="uc.edu"&&(n.establishment=new u({id:1,officialName:"University of Cincinnati",translatedName:"University of Cincinnati",officialUrl:"www.uc.edu",countryName:"United States",countryCode:"asdf",uCosmicCode:"asdf",ceebCode:"asdf"},this.owner)),this.tenantDomain==="suny.edu"&&(n.establishment=new u({id:1,officialName:"State University of New York",translatedName:"State University of New York",officialUrl:"www.suny.edu",countryName:"United States",countryCode:"asdf",uCosmicCode:"asdf",ceebCode:"asdf"},this.owner)),this.participants.push(n)},n.prototype.setupSearchVM=function(){var n=new f;n.sammy=undefined,n.nextPage=function(){if(n.nextEnabled()){var t=parseInt(n.pageNumber())+1;location.hash="/participants/add/page/"+t}},n.prevPage=function(){n.prevEnabled()&&history.back()},n.items.subscribe(function(n){if(n&&n.length)for(var t=0;t<n.length;t++)n[t].clickAction!==this.addParticipant&&(n[t].clickAction=this.addParticipant)})},n.prototype.removeParticipant=function(n,t){return confirm('Are you sure you want to remove "'+n.translatedName()+'" as a participant from this agreement?')&&this.participants.remove(function(t){return t.establishment.id()===n.id()&&$(t.participantEl).slideUp("fast",function(){this.participants.remove(t)}),!1}),t.preventDefault(),t.stopPropagation(),!1},n.prototype.addParticipant=function(n){var t=new e({isOwner:!1,establishment:n});this.participants.push(t),location.hash="#/"},n.prototype._setupSammy=function(){var n=this;n.sammy.before(n.sammyBeforeRoute,function(){n.beforePage(this)}),n.sammy.get(n.sammyGetPageRoute,function(){n.getPage(this)}),n.initDefaultPageRoute&&n.sammy.get(n.sammyDefaultPageRoute,function(){n.initPageHash(this)})},n.prototype.swipeCallback=function(){},n.prototype.lockAnimation=function(){this.nextForceDisabled(!0),this.prevForceDisabled(!0)},n.prototype.unlockAnimation=function(){this.nextForceDisabled(!1),this.prevForceDisabled(!1)},n.prototype.getPage=function(n){var t=this,i=this.trail(),r;if(!(i.length>0)||i[i.length-1]!==n.path){if(i.length>1&&i[i.length-2]===n.path){i.pop(),this.swipeCallback=function(){r=t.$itemsPage.clone(!0).removeAttr("data-bind").data("bind",undefined).removeAttr("id"),r.appendTo(t.$itemsPage.parent()),t.$itemsPage.attr("data-side-swiper","off").hide(),t.lockAnimation(),$(window).scrollTop(0),t.sideSwiper.prev(1,function(){t.$itemsPage.siblings().remove(),t.unlockAnimation()})};return}i.length>0&&(this.swipeCallback=function(){r=t.$itemsPage.clone(!0).removeAttr("data-bind").data("bind",undefined).removeAttr("id"),r.insertBefore(t.$itemsPage),t.$itemsPage.attr("data-side-swiper","off").hide(),t.lockAnimation(),$(window).scrollTop(0),t.sideSwiper.next(1,function(){t.unlockAnimation()})}),i.push(n.path)}},n.prototype.beforePage=function(n){if(this.nextForceDisabled()||this.prevForceDisabled())return!1;var t=n.params.pageNumber;return t&&parseInt(t)!==parseInt(this.pageNumber())&&this.pageNumber(parseInt(t)),!0},n.prototype.initPageHash=function(n){n.app.setLocation("#/page/1/")},n.prototype.setLocation=function(){var n="#/page/"+this.pageNumber()+"/";this.sammy.getLocation()!==n&&this.sammy.setLocation(n)},n}(),t.InstitutionalAgreementEditModel=o})