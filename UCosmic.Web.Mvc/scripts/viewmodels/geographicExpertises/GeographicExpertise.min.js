var ViewModels;(function(n){(function(n){var t=function(){function n(n){this.inititializationErrors="",this.saving=!1,this.selectedLocations=ko.observableArray(),this._initialize(n)}return n.prototype._initialize=function(n){this.id=ko.observable(n)},n.prototype.setupWidgets=function(n){var t=this;this.locationSelectorId=n,$("#"+n).kendoMultiSelect({filter:"contains",ignoreCase:!0,dataTextField:"officialName",dataValueField:"id",minLength:3,maxSelectedItems:1,dataSource:this.locationsDataSource,value:this.selectedLocations(),change:function(n){t.updateLocations(n.sender.value())},placeholder:"[Select Country/Location, Body of Water or Global]"})},n.prototype.setupValidation=function(){ko.validation.rules.numberNotNull={validator:function(n){return n!=null},message:"Required."},ko.validation.registerExtenders(),this.placeId.extend({numberNotNull:0}),this.description.extend({maxLength:400}),ko.validation.group(this)},n.prototype.load=function(){var n=this,i=$.Deferred(),r=$.Deferred(),t;return $.get(App.Routes.WebApi.Places.get()).done(function(n){r.resolve(n)}).fail(function(n,t,i){r.reject(n,t,i)}),t=$.Deferred(),$.ajax({type:"GET",url:App.Routes.WebApi.GeographicExpertises.get(this.id()),success:function(n){t.resolve(n)},error:function(n,i,r){t.reject(n,i,r)}}),$.when(r,t).done(function(t,r){n.locationsDataSource=t,ko.mapping.fromJS(r,{},n),n.selectedLocations.push(n.placeId()),i.resolve()}).fail(function(n,t,r){i.reject(n,t,r)}),i},n.prototype.save=function(n){var t=this,i;if(this.isValid()){while(this.saving)alert("Please wait while expertise is saved.");i=ko.mapping.toJS(this),this.saving=!0,$.ajax({type:"PUT",url:App.Routes.WebApi.GeographicExpertises.put(n.id()),data:i,dataType:"json",success:function(){t.saving=!1,location.href=App.Routes.Mvc.My.Profile.get(1)},error:function(n,i,r){t.saving=!1,alert(i+" | "+r),location.href=App.Routes.Mvc.My.Profile.get(1)}})}},n.prototype.isEmpty=function(){return this.placeOfficialName()=="Global"&&this.description()==null?!0:!1},n.prototype.cancel=function(){var n=this;$("#cancelConfirmDialog").dialog({modal:!0,resizable:!1,width:450,buttons:{"Do not cancel":function(){$(this).dialog("close")},"Cancel and lose changes":function(){$(this).dialog("close"),n.isEmpty()&&$.ajax({async:!1,type:"DELETE",url:App.Routes.WebApi.GeographicExpertises.del(n.id()),success:function(){},error:function(n,t){alert(t)}}),location.href=App.Routes.Mvc.My.Profile.get(1)}}})},n.prototype.updateLocations=function(n){this.placeId(n.length>0?n[0]:null)},n}();n.GeographicExpertise=t})(n.GeographicExpertises||(n.GeographicExpertises={}));var t=n.GeographicExpertises})(ViewModels||(ViewModels={}))