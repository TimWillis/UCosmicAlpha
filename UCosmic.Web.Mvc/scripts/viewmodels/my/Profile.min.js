var ViewModels;(function(n){(function(n){var t=function(){function n(){var n=this;this._isInitialized=!1,this.isDisplayNameDerived=ko.observable(),this.displayName=ko.observable(),this._userDisplayName="",this.salutation=ko.observable(),this.firstName=ko.observable(),this.middleName=ko.observable(),this.lastName=ko.observable(),this.suffix=ko.observable(),this.facultyRanks=ko.observableArray(),this.facultyRankId=ko.observable(),this.jobTitles=ko.observable(),this.administrativeAppointments=ko.observable(),this.gender=ko.observable(),this.isActive=ko.observable(),this.$photo=ko.observable(),this.$facultyRanks=ko.observable(),this.$nameSalutation=ko.observable(),this.$nameSuffix=ko.observable(),this._initialize(),this.isFacultyRanksVisible=ko.computed(function(){return n.facultyRanks()&&n.facultyRanks().length>0}),this._setupValidation(),this._setupKendoWidgets(),this._setupDisplayNameDerivation()}return n.prototype._initialize=function(){var n=this,i=$.Deferred(),t;$.get(App.Routes.WebApi.Employees.ModuleSettings.FacultyRanks.get()).done(function(n){i.resolve(n)}).fail(function(n,t,r){i.reject(n,t,r)}),t=$.Deferred(),$.get(App.Routes.WebApi.My.Profile.get()).done(function(n){t.resolve(n)}).fail(function(n,i,r){t.reject(n,i,r)}),$.when(i,t).then(function(t,i){n.facultyRanks(t),ko.mapping.fromJS(i,{},n),$(n).trigger("ready"),n._isInitialized=!0,n.$facultyRanks().kendoDropDownList()},function(){})},n.prototype.saveInfo=function(){if(this.isValid()){var n=ko.mapping.toJS(this);$.ajax({url:App.Routes.WebApi.My.Profile.put(),type:"PUT",data:n}).done(function(){}).fail(function(){}),$("#accordion").accordion("activate",1)}else this.errors.showAllMessages()},n.prototype.savePicture=function(){$("#accordion").accordion("activate",0)},n.prototype._setupValidation=function(){this.displayName.extend({required:{message:"Display name is required."},maxLength:200}),this.salutation.extend({maxLength:50}),this.firstName.extend({maxLength:100}),this.middleName.extend({maxLength:100}),this.lastName.extend({maxLength:100}),this.suffix.extend({maxLength:50}),this.jobTitles.extend({maxLength:500}),this.administrativeAppointments.extend({maxLength:500}),ko.validation.group(this)},n.prototype._setupKendoWidgets=function(){this.$nameSalutation.subscribe(function(n){n&&n.length&&n.kendoComboBox({dataTextField:"text",dataValueField:"value",dataSource:new kendo.data.DataSource({transport:{read:{url:App.Routes.WebApi.People.Names.Salutations.get()}}})})}),this.$nameSuffix.subscribe(function(n){n&&n.length&&n.kendoComboBox({dataTextField:"text",dataValueField:"value",dataSource:new kendo.data.DataSource({transport:{read:{url:App.Routes.WebApi.People.Names.Suffixes.get()}}})})}),this.$photo.subscribe(function(n){n&&n.length&&n.kendoUpload({multiple:!1,localization:{select:"Choose a photo to upload..."}})})},n.prototype._setupDisplayNameDerivation=function(){var n=this;this.displayName.subscribe(function(t){n.isDisplayNameDerived()||(n._userDisplayName=t)}),ko.computed(function(){if(n.isDisplayNameDerived()&&n._isInitialized){var t=ko.mapping.toJS(n);$.ajax({url:App.Routes.WebApi.People.Names.DeriveDisplayName.get(),type:"GET",cache:!1,data:t}).done(function(t){n.displayName(t)})}else n._isInitialized&&(n._userDisplayName||(n._userDisplayName=n.displayName()),n.displayName(n._userDisplayName))}).extend({throttle:400})},n}();n.Profile=t})(n.My||(n.My={}));var t=n.My})(ViewModels||(ViewModels={}))