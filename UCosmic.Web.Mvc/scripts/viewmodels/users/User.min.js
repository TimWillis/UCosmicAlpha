var ViewModels;(function(n){(function(t){var r=function(){function n(){this._ruleName="validUserName",this._isAwaitingResponse=!1,this.async=!0,this.message="error",ko.validation.rules[this._ruleName]=this,ko.validation.addExtender(this._ruleName)}return n.prototype.validator=function(n,t,i){var u=this,r;this._isAwaitingResponse||(r=App.Routes.WebApi.Identity.Users.validateName(t.id()),this._isAwaitingResponse=!0,$.post(r,{name:t.name()}).always(function(){u._isAwaitingResponse=!1}).done(function(){i(!0)}).fail(function(n){i({isValid:!1,message:n.responseText})}))},n}(),i;new r,i=function(){function t(){var t=this;this.id=ko.observable(),this.name=ko.observable(),this.saveSpinner=new n.Spinner({delay:200,isVisible:!1}),this.errorMessage=ko.observable(),this.name.extend({required:{message:"Username is required."},maxLength:256,validUserName:this}),this.isValidating=ko.computed(function(){return t.name.isValidating()}),ko.validation.group(this)}return t.prototype.save=function(){var n=this,t,i;if(this.saveSpinner.start(),this.isValidating())return setTimeout(function(){n.save()},50),!1;if(!this.isValid())return this.errors.showAllMessages(),this.saveSpinner.stop(),!1;t=App.Routes.WebApi.Identity.Users.post(),i={name:this.name()},$.post(t,i).done(function(n,t,i){window.location.href=App.Routes.Mvc.Identity.Users.created({location:i.getResponseHeader("Location")})}).fail(function(){n.errorMessage("An unexpected error occurred while trying to create this user.")}),this.saveSpinner.stop()},t}(),t.User=i})(n.Users||(n.Users={}));var t=n.Users})(ViewModels||(ViewModels={}))