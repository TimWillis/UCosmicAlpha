var ViewModels;(function(n){(function(n){var t=function(){function n(){this.id=ko.observable();this.name=ko.observable();this.saveSpinner=new App.Spinner({delay:200});this.errorMessage=ko.observable();this.isWarned=ko.observable(sessionStorage.getItem("UserCreateFormIsWarned")||!1);this.name.extend({required:{message:"Username is required."},maxLength:256,validUserName:this});ko.validation.group(this)}return n.prototype.acceptWarning=function(){this.isWarned(!0);sessionStorage.setItem("UserCreateFormIsWarned",this.isWarned().toString())},n.prototype.save=function(){var n=this;if(!this.isValid())return this.errors.showAllMessages(),!1;if(this.saveSpinner.start(),$.ajax({type:"POST",async:!1,url:App.Routes.WebApi.Identity.Users.validateName(this.id()),data:{name:this.name()},success:function(){n.errorMessage(null)},error:function(t){n.errorMessage(t.responseText)}}),this.errorMessage()!=null){this.saveSpinner.stop();return}$.ajax({type:"POST",async:!0,url:App.Routes.WebApi.Identity.Users.post(),data:{name:this.name()},success:function(n,t,i){window.location.href=App.Routes.Mvc.Identity.Users.created({location:i.getResponseHeader("Location")})},error:function(){n.errorMessage("An unexpected error occurred while trying to create this user.")},complete:function(){n.saveSpinner.stop()}})},n}();n.User=t})(n.Users||(n.Users={}));var t=n.Users})(ViewModels||(ViewModels={}));