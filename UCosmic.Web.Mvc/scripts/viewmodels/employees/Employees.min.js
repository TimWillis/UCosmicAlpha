var ViewModels;(function(n){(function(n){var t=function(){function n(n){this.inititializationErrors="",this._initialize(n)}return n.prototype._initialize=function(n){if(this.initialLocations=[],this.selectedLocationValues=[],this.fromDate=ko.observable(),this.toDate=ko.observable(),this.institutionId=ko.observable(null),this.institutionOfficialName=ko.observable(null),this.institutionCountryOfficialName=ko.observable(null),this.institutionHasCampuses=ko.observable(!1),this.activityTypes=ko.observableArray(),this.isHeatmapVisible=ko.observable(!0),this.isPointmapVisible=ko.observable(!1),this.isTableVisible=ko.observable(!1),this.searchType=ko.observable("activities"),n!=null){if(n.InstitutionId!=null&&this.institutionId(Number(n.InstitutionId)),n.ActivityTypes!=null)for(var t=0;t<n.ActivityTypes.length;t+=1)this.activityTypes.push(ko.observable({id:n.ActivityTypes[t].Id,type:n.ActivityTypes[t].Name,filter:ko.observable(!0)}));n.InstitutionHasCampuses!=null&&this.institutionHasCampuses(Boolean(n.InstitutionHasCampuses))}},n.prototype.setupWidgets=function(n,t,i,r,u,f,e){var o=this,h,c,l,s;for(this.locationSelectorId=n,h=this,$("#"+n).kendoMultiSelect({autoBind:!0,dataTextField:"officialName",dataValueField:"id",minLength:3,dataSource:h.initialLocations,value:h.selectedLocationValues,change:function(n){o.updateLocations(n.sender.dataItems())},placeholder:"[Select Country/Location]"}),$("#"+t).kendoDatePicker({open:function(){this.options.format="MM/dd/yyyy"}}),$("#"+i).kendoDatePicker({open:function(){this.options.format="MM/dd/yyyy"}}),this.institutionSelectorId=r,$("#"+r).kendoAutoComplete({minLength:3,filter:"contains",ignoreCase:!0,placeholder:"[Enter Institution]",dataTextField:"officialName",dataSource:new kendo.data.DataSource({serverFiltering:!0,transport:{read:function(n){$.ajax({url:App.Routes.WebApi.Establishments.getUniversities(),dataType:"json",success:function(t){n.success(t.items)}})}}}),change:function(){o.checkInstitutionForNull()},select:function(n){var i=$("#"+r).data("kendoAutoComplete"),t=i.dataItem(n.item.index());o.institutionOfficialName(t.officialName),o.institutionId(t.id),t.countryName!=null&&t.countryName.length>0?o.institutionCountryOfficialName(t.countryName):o.institutionCountryOfficialName(null)}}),$("#"+e).kendoDropDownList({dataTextField:"officialName",dataValueField:"id",optionLabel:{officialName:"ALL",id:0},change:function(){},dataBound:function(){if(this.selectedIndex!=null&&this.selectedIndex!=-1){var n=this.dataItem(this.selectedIndex);n==null?(this.text(""),$("#departmenDiv").hide()):$("#departmenDiv").show()}else $("#departmenDiv").hide()}}),c=null,this.institutionHasCampuses()||(c=new kendo.data.DataSource({transport:{read:{url:App.Routes.WebApi.Establishments.getChildren(this.institutionId(),!0)}}})),$("#"+f).kendoDropDownList({dataTextField:"officialName",dataValueField:"id",optionLabel:{officialName:"ALL",id:0},dataSource:c,change:function(n){var i=n.sender.selectedIndex,t,r;i!=-1&&(t=this.dataItem(i),t!=null&&t.id!=0&&(r=new kendo.data.DataSource({transport:{read:{url:App.Routes.WebApi.Establishments.getChildren(t.id,!0)}}}),$("#"+e).data("kendoDropDownList").setDataSource(r)))},dataBound:function(){var n,t,i;this.selectedIndex!=null&&this.selectedIndex!=-1&&(n=this.dataItem(this.selectedIndex),n!=null&&n.id!=0&&(t=n.id,t!=null&&(i=new kendo.data.DataSource({transport:{read:{url:App.Routes.WebApi.Establishments.getChildren(t,!0)}}}),$("#"+e).data("kendoDropDownList").setDataSource(i))))}}),this.institutionHasCampuses()&&$("#"+u).kendoDropDownList({dataTextField:"officialName",dataValueField:"id",optionLabel:{officialName:"ALL",id:0},dataSource:new kendo.data.DataSource({transport:{read:{url:App.Routes.WebApi.Establishments.getChildren(this.institutionId(),!0)}}}),change:function(n){var i=n.sender.selectedIndex,t,r;i!=null&&i!=-1&&(t=this.dataItem(i),t!=null&&t.id!=0&&(r=new kendo.data.DataSource({transport:{read:{url:App.Routes.WebApi.Establishments.getChildren(t.id,!0)}}}),$("#"+f).data("kendoDropDownList").setDataSource(r)))},dataBound:function(){var n,t,i;this.selectedIndex!=null&&this.selectedIndex!=-1&&(n=this.dataItem(this.selectedIndex),n!=null&&n.id!=0?(t=n.id,t!=null&&(i=new kendo.data.DataSource({transport:{read:{url:App.Routes.WebApi.Establishments.getChildren(t,!0)}}}),$("#"+f).data("kendoDropDownList").setDataSource(i))):$("#"+f).data("kendoDropDownList").setDataSource(null))}}),l=[],s=0;s<this.activityTypes().length;s+=1)l.push({type:this.activityTypes()[s].type(),selected:!1});$("#heatmapActivityDropList").kendoDropDownList({dataTextField:"type",dataValueField:"selected",dataSource:l})},n.prototype.setupValidation=function(){},n.prototype.setupSubscriptions=function(){},n.prototype.load=function(){var i=this,r=this,n=$.Deferred(),t=$.Deferred();return $.get(App.Routes.WebApi.Employees.ModuleSettings.ActivityTypes.get()).done(function(n){t.resolve(n)}).fail(function(n,i,r){t.reject(n,i,r)}),$.when(t).done(function(t){i.activityTypes=ko.mapping.fromJS(t),n.resolve()}).fail(function(t,i,r){n.reject(t,i,r)}),n},n.prototype.checkInstitutionForNull=function(){var t=$("#"+this.institutionSelectorId).data("kendoAutoComplete"),n=t.value()!=null?t.value().toString():null;n!=null&&(n=$.trim(n)),(n==null||n.length==0)&&(t.value(null),this.institutionOfficialName(null),this.institutionId(null))},n.prototype.updateLocations=function(n){var t,i;if(this.locations!=null)for(this.locations.removeAll(),t=0;t<n.length;t+=1)i=ko.mapping.fromJS({id:0,placeId:n[t].id,version:""}),this.locations.push(i)},n.prototype.selectMap=function(n){$("#heatmapText").css("font-weight","normal"),this.isHeatmapVisible(!1),$("#pointmapText").css("font-weight","normal"),this.isPointmapVisible(!1),$("#resultstableText").css("font-weight","normal"),this.isTableVisible(!1),n==="heatmap"?($("#heatmapText").css("font-weight","bold"),this.isHeatmapVisible(!0)):n==="pointmap"?($("#pointmapText").css("font-weight","bold"),this.isPointmapVisible(!0)):n==="resultstable"&&($("#resultstableText").css("font-weight","bold"),this.isTableVisible(!0))},n}();n.FacultyAndStaff=t})(n.Employees||(n.Employees={}));var t=n.Employees})(ViewModels||(ViewModels={}))